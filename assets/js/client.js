(function(f){var b=false,e=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;var c=function(){};c.extend=function(k){var j=this.prototype;b=true;var i=new this();b=false;for(var h in k){i[h]=typeof k[h]=="function"&&typeof j[h]=="function"&&e.test(k[h])?(function(l,m){return function(){var o=this._super;this._super=j[l];var n=m.apply(this,arguments);this._super=o;return n}})(h,k[h]):k[h]}function g(){if(!b&&this.init){this.init.apply(this,arguments)}}g.prototype=i;g.prototype.constructor=g;g.extend=c.extend;return g};var d={debug:false,trace:function(g){if(this.debug&&f.console!==undefined){f.console.log("Porthole: "+g)}},error:function(g){if(typeof f.console!==undefined&&typeof f.console.error==="function"){f.console.error("Porthole: "+g)}}};d.WindowProxy=function(){};d.WindowProxy.prototype={post:function(h,g){},addEventListener:function(g){},removeEventListener:function(g){}};d.WindowProxyBase=c.extend({init:function(g){if(g===undefined){g=""}this.targetWindowName=g;this.origin=f.location.protocol+"//"+f.location.host;this.eventListeners=[]},getTargetWindowName:function(){return this.targetWindowName},getOrigin:function(){return this.origin},getTargetWindow:function(){return d.WindowProxy.getTargetWindow(this.targetWindowName)},post:function(h,g){if(g===undefined){g="*"}this.dispatchMessage({data:h,sourceOrigin:this.getOrigin(),targetOrigin:g,sourceWindowName:f.name,targetWindowName:this.getTargetWindowName()})},addEventListener:function(g){this.eventListeners.push(g);return g},removeEventListener:function(h){var g;try{g=this.eventListeners.indexOf(h);this.eventListeners.splice(g,1)}catch(i){this.eventListeners=[]}},dispatchEvent:function(h){var g;for(g=0;g<this.eventListeners.length;g++){try{this.eventListeners[g](h)}catch(j){d.error(j)}}}});d.WindowProxyLegacy=d.WindowProxyBase.extend({init:function(g,h){this._super(h);if(g!==null){this.proxyIFrameName=this.targetWindowName+"ProxyIFrame";this.proxyIFrameLocation=g;this.proxyIFrameElement=this.createIFrameProxy()}else{this.proxyIFrameElement=null;d.trace("proxyIFrameUrl is null, window will be a receiver only");this.post=function(){throw new Error("Receiver only window")}}},createIFrameProxy:function(){var g=document.createElement("iframe");g.setAttribute("id",this.proxyIFrameName);g.setAttribute("name",this.proxyIFrameName);g.setAttribute("src",this.proxyIFrameLocation);g.setAttribute("frameBorder","1");g.setAttribute("scrolling","auto");g.setAttribute("width",30);g.setAttribute("height",30);g.setAttribute("style","position: absolute; left: -100px; top:0px;");if(g.style.setAttribute){g.style.setAttribute("cssText","position: absolute; left: -100px; top:0px;")}document.body.appendChild(g);return g},dispatchMessage:function(h){var g=f.encodeURIComponent;if(this.proxyIFrameElement){var i=this.proxyIFrameLocation+"#"+g(d.WindowProxy.serialize(h));this.proxyIFrameElement.setAttribute("src",i);this.proxyIFrameElement.height=this.proxyIFrameElement.height>50?50:100}}});d.WindowProxyHTML5=d.WindowProxyBase.extend({init:function(g,h){this._super(h);this.eventListenerCallback=null},dispatchMessage:function(g){this.getTargetWindow().postMessage(d.WindowProxy.serialize(g),g.targetOrigin)},addEventListener:function(h){if(this.eventListeners.length===0){var g=this;if(f.addEventListener){this.eventListenerCallback=function(i){g.eventListener(g,i)};f.addEventListener("message",this.eventListenerCallback,false)}else{if(f.attachEvent){this.eventListenerCallback=function(i){g.eventListener(g,f.event)};f.attachEvent("onmessage",this.eventListenerCallback)}}}return this._super(h)},removeEventListener:function(g){this._super(g);if(this.eventListeners.length===0){if(f.removeEventListener){f.removeEventListener("message",this.eventListenerCallback)}else{if(f.detachEvent){if(typeof f.onmessage==="undefined"){f.onmessage=null}f.detachEvent("onmessage",this.eventListenerCallback)}}this.eventListenerCallback=null}},eventListener:function(h,g){var i=d.WindowProxy.unserialize(g.data);if(i&&(h.targetWindowName===""||i.sourceWindowName==h.targetWindowName)){h.dispatchEvent(new d.MessageEvent(i.data,g.origin,h))}}});if(!f.postMessage){d.trace("Using legacy browser support");d.WindowProxy=d.WindowProxyLegacy.extend({})}else{d.trace("Using built-in browser support");d.WindowProxy=d.WindowProxyHTML5.extend({})}d.WindowProxy.serialize=function(g){if(typeof JSON==="undefined"){throw new Error("Porthole serialization depends on JSON!")}return JSON.stringify(g)};d.WindowProxy.unserialize=function(i){if(typeof JSON==="undefined"){throw new Error("Porthole unserialization dependens on JSON!")}try{var g=JSON.parse(i)}catch(h){return false}return g};d.WindowProxy.getTargetWindow=function(g){if(g===""){return parent}else{if(g==="top"||g==="parent"){return f[g]}}return f.frames[g]};d.MessageEvent=function a(i,g,h){this.data=i;this.origin=g;this.source=h};d.WindowProxyDispatcher={forwardMessageEvent:function(k){var i,j=f.decodeURIComponent,h,g;if(document.location.hash.length>0){i=d.WindowProxy.unserialize(j(document.location.hash.substr(1)));h=d.WindowProxy.getTargetWindow(i.targetWindowName);g=d.WindowProxyDispatcher.findWindowProxyObjectInWindow(h,i.sourceWindowName);if(g){if(g.origin===i.targetOrigin||i.targetOrigin==="*"){g.dispatchEvent(new d.MessageEvent(i.data,i.sourceOrigin,g))}else{d.error("Target origin "+g.origin+" does not match desired target of "+i.targetOrigin)}}else{d.error("Could not find window proxy object on the target window")}}},findWindowProxyObjectInWindow:function(g,j){var h;if(g){for(h in g){if(Object.prototype.hasOwnProperty.call(g,h)){try{if(g[h]!==null&&typeof g[h]==="object"&&g[h] instanceof g.Porthole.WindowProxy&&g[h].getTargetWindowName()===j){return g[h]}}catch(k){}}}}return null},start:function(){if(f.addEventListener){f.addEventListener("resize",d.WindowProxyDispatcher.forwardMessageEvent,false)}else{if(f.attachEvent&&f.postMessage!=="undefined"){f.attachEvent("onresize",d.WindowProxyDispatcher.forwardMessageEvent)}else{if(document.body.attachEvent){f.attachEvent("onresize",d.WindowProxyDispatcher.forwardMessageEvent)}else{d.error("Cannot attach resize event")}}}}};if(typeof exports!=="undefined"){module.exports=d}else{f.Porthole=d}})(typeof window!=="undefined"?window:this);
RoutePlannerWidget=function(){this.containerObject=null,this.options={name:null,containerId:null,css:null,currency:null,measure:null,calculateInstantly:!1,customizedCostFormula:null,customizedCostLabel:null,defaultFrom:null,defaultTo:null,defaultVia:null,defaultSpeedLimitMotorway:null,defaultSpeedLimitOther:null,defaultFuelPrice:null,defaultFuelConsumption:null,showVia:!1,showSpeedProfile:!1,showFuelCalc:!1,showResultLength:!1,showResultDrivingTime:!1,showResultFuelAmount:!1,showResultFuelCost:!1,showResultCustomizedCost:!1,showResultMap:!1,showResultScheme:!1,hideFrom:!1,hideTo:!1,onlyCountries:null,preferCountries:null,disableFontAutoTuning:!1,fontFamily:null,fontSize:null}},RoutePlannerWidget.prototype.notSendedOptions=["name","containerId","disableFontAutoTuning"],RoutePlannerWidget.prototype.optionToAttribute=function(t){return"data-"+t.replace(/([A-Z])/g,"-$1").toLowerCase()},RoutePlannerWidget.prototype.getOption=function(t){return this.options[t]},RoutePlannerWidget.prototype.setOption=function(t,e){return this.options[t]=e,this},RoutePlannerWidget.prototype.totalDistance=RoutePlannerWidget.prototype.totalTime=RoutePlannerWidget.prototype.fuelAmount=RoutePlannerWidget.prototype.fuelCost=RoutePlannerWidget.prototype.fuelPrice=RoutePlannerWidget.prototype.fuelConsumption=RoutePlannerWidget.prototype.customizedCost=null,RoutePlannerWidget.prototype.routeReady=null,RoutePlannerWidgetCollectionPrototype=function(){this.widgets=[]},RoutePlannerWidgetCollectionPrototype.prototype.readyWidgetsCount=0,RoutePlannerWidgetCollectionPrototype.prototype.ready=null,RoutePlannerWidgetCollectionPrototype.prototype.getWidgets=function(){return this.widgets},RoutePlannerWidgetCollectionPrototype.prototype.getWidgetByName=function(t){for(var e=0;e<this.widgets.length;e++)if(this.widgets[e].options.name===t)return this.widgets[e]},RoutePlannerWidgetCollectionPrototype.prototype.countReadyWidget=function(){this.readyWidgetsCount++,this.readyWidgetsCount==this.widgets.length&&null!==this.ready&&this.ready()},RoutePlannerWidgetCollectionPrototype.prototype.catchEvents=function(a,r,s,u){a.addEventListener(function(t){var e=t.data.action,o=function(t){u.getElementsByTagName("iframe")[0].style.height=t+"px"};if(matches=e.match(/^h(\d+)$/))o(matches[1]);else if(matches=e.match(/^hr(\d+)/))o(matches[1]),a.post({action:"ok"});else if(matches=e.match(/^get_widget_view_params$/)){t=u.getElementsByTagName("iframe")[0].getBoundingClientRect(),o=window.innerHeight;a.post({action:"get_widget_view_params-answer-"+o+"-"+t.top})}else if("fl"==e)r.countReadyWidget();else if(matches=e.match(/^flr-(\S+)/)){for(var n=matches[1].split(":"),i=0;i<n.length;i++)if(n[i].length){var l=n[i].split("=");switch(l[0]){case"td":s.totalDistance=l[1];break;case"tt":s.totalTime=l[1];break;case"tfc":s.fuelAmount=l[1];break;case"tp":s.fuelCost=l[1];break;case"fp":s.fuelPrice=l[1];break;case"fc":s.fuelConsumption=l[1];break;case"fcc":s.customizedCost=l[1]}}null!==s.routeReady&&s.routeReady()}})},RoutePlannerWidgetCollectionPrototype.prototype.init=function(){for(var t=document.querySelectorAll(".rp-widget-link"),e=0;e<t.length;e++){var o=t[e];if("a"===o.tagName.toLowerCase()){var n=document.createElement("div");n.setAttribute("class","rp-widget"),n.style.display="inline-block",n.style.width="100%",n.style.position="relative",n.style.overflow="hidden";var i=document.createElement("div");i.innerHTML="&nbsp;",i.style.display="block",i.style.width="auto",i.style.margin="0",i.style.padding="0",i.className="rp-widget-link-container";var l=document.createElement("div");l.setAttribute("class","rp-widget-content"),o.parentNode.insertBefore(n,o),o.parentNode.removeChild(o),n.appendChild(l),n.appendChild(i),i.appendChild(o);var a,r=new RoutePlannerWidget;for(a in r.setOption("name","rp"+e),r.options){var s=r.optionToAttribute(a);o.hasAttribute(s)&&(s.match(/^data-show-/)||"data-calculate-instantly"==s||"data-disable-font-auto-tuning"==s||s.match(/^data-hide-/)?r.setOption(a,!0):r.setOption(a,o.getAttribute(s)))}i=o.getAttribute("href");r.domain=i.match(/^https{0,1}:\/\/(.*?)([\/?]|$)/)[1],r.setOption("containerId","rp-embed-"+r.options.name),r.ready=this.countReadyWidget,r.options.disableFontAutoTuning||(null!=r.options.fontFamily||"-webkit-standard"!=(i=window.getComputedStyle(o,null).getPropertyValue("font-family"))&&(r.options.fontFamily=i),null==r.options.fontSize&&(r.options.fontSize=window.getComputedStyle(o,null).getPropertyValue("font-size"))),this.widgets.push(r),l.setAttribute("id",r.options.containerId)}}for(var u=0;u<this.widgets.length;u++){var d,p=this.widgets[u],c=location.protocol+"//"+p.domain,g=c+"/widget/v1/home",h="",h=p.options.calculateInstantly?c+"/widget/v1/route?":g+"?",m=[];for(d in p.options)p.options.hasOwnProperty(d)&&-1===p.notSendedOptions.indexOf(d)&&(!0===p.options[d]||!1===p.options[d]?m.push(d+"="+ +p.options[d]):null!==p.options[d]&&m.push(d+"="+encodeURIComponent(p.options[d])));h+=m.join("&");var y=document.createElement("iframe"),f=p.options.containerId+"-iframe";y.setAttribute("name",f),y.setAttribute("id",f),y.setAttribute("src",h),y.setAttribute("style","overflow:hidden;border-style:none;width:100%"),y.setAttribute("scrolling","no"),y.setAttribute("allowTransparency","true"),y.setAttribute("allowfullscreen","");h=document.getElementById(p.options.containerId);h.appendChild(y);f=new Porthole.WindowProxy(g+"/proxy",f);RoutePlannerWidgetCollectionPrototype.prototype.catchEvents(f,this,p,h);h=new XMLHttpRequest;h.open("POST",c+"/widget/v1/statistic",!0),h.send("host="+encodeURIComponent(window.location.hostname))}},"undefined"==typeof RoutePlannerWidgetCollection&&(RoutePlannerWidgetCollection=new RoutePlannerWidgetCollectionPrototype,RoutePlannerWidgetCollection.init());